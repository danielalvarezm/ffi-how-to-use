version: '3'
silent: true
tasks:
  build:
    desc: "ğŸ—ï¸ Generate C shared library, dependencies and executable"
    cmds:
      - test -d native_code/build || mkdir -p native_code/build
      - cd native_code/build && cmake .. && cmake --build . && make

  ffigen:
    desc: "âš™ï¸ Generate dart code with ffigen from C lang"
    cmds:
      - flutter pub run ffigen

  generate:
    desc: "ï¸â›“ï¸ Generate dependencies and bindings"
    cmds:
      - dart pub get
      - task build
      - task ffigen

  run:
    desc: "ğŸš€ Run Dart app without generate dependencies and bindings"
    cmds:
      - dart run bin/ffi_example.dart

  execute:
    desc: "ğŸš€ Run Dart app"
    cmds:
      - task generate
      - task run

  default:
    cmds:
      - task -l --sort none